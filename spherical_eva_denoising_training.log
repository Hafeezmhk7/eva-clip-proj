2025-07-27 03:36:00,227 - INFO - üöÄ Starting Spherical EVA-CLIP Denoising with Fixed BLIP3-o DiT
2025-07-27 03:36:00,228 - INFO - ================================================================================
2025-07-27 03:36:00,228 - INFO - üéØ SPHERICAL EVA DENOISING TASK:
2025-07-27 03:36:00,228 - INFO -   üìã Task: Denoise noisy EVA embeddings using clean EVA guidance
2025-07-27 03:36:00,229 - INFO -   üß† Model: Spherical BLIP3-o DiT with cross-attention conditioning
2025-07-27 03:36:00,229 - INFO -   üì• Input: Noisy EVA embeddings [B, N, 4096]
2025-07-27 03:36:00,229 - INFO -   üéÆ Conditioning: Clean EVA embeddings [B, N, 4096]
2025-07-27 03:36:00,229 - INFO -   üì§ Output: Clean EVA embeddings [B, N, 4096]
2025-07-27 03:36:00,229 - INFO -   üåä Method: Spherical Flow Matching with SLERP interpolation
2025-07-27 03:36:00,229 - INFO -   üéØ Goal: High cosine similarity on evaluation
2025-07-27 03:36:00,229 - INFO - ================================================================================
2025-07-27 03:36:00,229 - INFO - Configuration:
2025-07-27 03:36:00,229 - INFO -   Model size: base
2025-07-27 03:36:00,229 - INFO -   Training mode: patch_only
2025-07-27 03:36:00,229 - INFO -   Prediction type: velocity
2025-07-27 03:36:00,229 - INFO -   Embeddings dir: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-07-27 03:36:00,229 - INFO -   Output dir: ./checkpoints/eva_repro_fixed_20250727_033558
2025-07-27 03:36:00,229 - INFO -   Learning rate: 0.0005
2025-07-27 03:36:00,229 - INFO -   Batch size: 8
2025-07-27 03:36:00,229 - INFO -   Epochs: 10
2025-07-27 03:36:00,229 - INFO -   Max shards: 1
2025-07-27 03:36:00,229 - INFO -   Noise schedule: uniform
2025-07-27 03:36:00,229 - INFO -   Noise range: [0.1, 0.9]
2025-07-27 03:36:00,229 - INFO -   Sphere constraint weight: 0.1
2025-07-27 03:36:00,229 - INFO -   üß™ OVERFITTING TEST: 20 samples
2025-07-27 03:36:00,229 - INFO -   Debug mode: True
2025-07-27 03:36:00,229 - INFO - ================================================================================
2025-07-27 03:36:00,229 - INFO - üîß KEY FIXES IMPLEMENTED:
2025-07-27 03:36:00,229 - INFO -   ‚úÖ Spherical flow matching with SLERP interpolation
2025-07-27 03:36:00,229 - INFO -   ‚úÖ Unit hypersphere constraints maintained
2025-07-27 03:36:00,229 - INFO -   ‚úÖ Cross-attention conditioning with clean EVA
2025-07-27 03:36:00,229 - INFO -   ‚úÖ Proper gradient flow and initialization
2025-07-27 03:36:00,229 - INFO -   ‚úÖ Comprehensive spherical evaluation metrics
2025-07-27 03:36:00,229 - INFO -   ‚úÖ Gradient clipping for stability
2025-07-27 03:36:00,229 - INFO -   ‚úÖ EVA ‚Üí EVA denoising (not CLIP ‚Üí EVA)
2025-07-27 03:36:00,230 - INFO - ================================================================================
2025-07-27 03:36:01,904 - INFO - Using GPU: NVIDIA H100
2025-07-27 03:36:01,904 - INFO - GPU Memory: 100.0 GB
2025-07-27 03:36:05,034 - INFO - ‚úÖ Spherical EVA denoising model loaded successfully
2025-07-27 03:36:05,035 - INFO - ‚úÖ Spherical flow matching loss loaded successfully
2025-07-27 03:36:05,035 - INFO - ‚úÖ Spherical EVA trainer loaded successfully
2025-07-27 03:36:05,036 - INFO - ‚úÖ EVA denoising dataset loaded successfully
2025-07-27 03:36:05,036 - WARNING - ‚ö†Ô∏è Missing original components: ['model', 'loss', 'trainer', 'dataset', 'config']
2025-07-27 03:36:05,036 - INFO - üéâ All spherical EVA denoising components loaded successfully!
2025-07-27 03:36:05,037 - WARNING - ‚ö†Ô∏è Missing legacy EVA components: ['legacy_eva_model', 'legacy_eva_loss', 'legacy_eva_trainer', 'legacy_eva_dataset']
2025-07-27 03:36:05,037 - INFO - üéâ SPHERICAL EVA DENOISING components ready! (RECOMMENDED)
2025-07-27 03:36:05,037 - INFO -   Input: Noisy EVA embeddings [B, N, 4096]
2025-07-27 03:36:05,037 - INFO -   Conditioning: Clean EVA embeddings [B, N, 4096]
2025-07-27 03:36:05,037 - INFO -   Output: Clean EVA embeddings [B, N, 4096]
2025-07-27 03:36:05,037 - INFO -   Features: Spherical flow matching, proper gradient flow, slerp interpolation
2025-07-27 03:36:05,037 - WARNING - ‚ö†Ô∏è Some original BLIP3-o components failed to load. Check individual imports.
2025-07-27 03:36:05,037 - WARNING - ‚ö†Ô∏è Some legacy EVA reproduction components failed to load.
2025-07-27 03:36:05,037 - INFO - üéØ READY: Use spherical EVA denoising for your project!
2025-07-27 03:36:05,037 - INFO -   Use: create_spherical_eva_model, create_spherical_flow_loss, etc.
2025-07-27 03:36:05,037 - INFO - Creating base spherical EVA model for patch_only mode...
2025-07-27 03:36:05,037 - INFO - Prediction type: velocity
2025-07-27 03:36:06,904 - INFO - Spherical EVA DiT model initialized with 212,073,472 parameters
2025-07-27 03:36:06,904 - INFO -   Input: Noisy EVA [B, N, 4096]
2025-07-27 03:36:06,904 - INFO -   Conditioning: Clean EVA [B, N, 4096]
2025-07-27 03:36:06,904 - INFO -   Output: velocity [B, N, 4096]
2025-07-27 03:36:06,904 - INFO -   Prediction type: velocity
2025-07-27 03:36:07,138 - INFO - Spherical EVA model created with 212,073,472 parameters
2025-07-27 03:36:07,139 - INFO - Model moved to cuda
2025-07-27 03:36:07,139 - INFO - Creating spherical flow matching loss...
2025-07-27 03:36:07,139 - INFO - Spherical Flow Matching Loss initialized:
2025-07-27 03:36:07,139 - INFO -   Prediction type: velocity
2025-07-27 03:36:07,139 - INFO -   Loss weight: 1.0
2025-07-27 03:36:07,139 - INFO -   Sphere constraint weight: 0.1
2025-07-27 03:36:07,139 - INFO -   Debug mode: True
2025-07-27 03:36:07,139 - INFO - Spherical flow matching loss created
2025-07-27 03:36:07,139 - INFO - Creating EVA denoising dataloaders...
2025-07-27 03:36:07,139 - INFO - Creating EVA denoising dataloaders:
2025-07-27 03:36:07,139 - INFO -   TASK: EVA-CLIP Denoising
2025-07-27 03:36:07,139 - INFO -   INPUT: Noisy EVA embeddings [B, N, 4096]
2025-07-27 03:36:07,139 - INFO -   CONDITIONING: Clean EVA embeddings [B, N, 4096]
2025-07-27 03:36:07,139 - INFO -   TARGET: Clean EVA embeddings [B, N, 4096]
2025-07-27 03:36:07,139 - INFO -   Noise schedule: uniform
2025-07-27 03:36:07,139 - INFO -   Noise range: [0.1, 0.9]
2025-07-27 03:36:07,140 - INFO - Loaded manifest: 1 shards, 2,646 samples
2025-07-27 03:36:07,140 - INFO - Found 1 files with pattern: embeddings_shard_*_patch_only.pkl
2025-07-27 03:36:07,140 - INFO - Prepared 1 shard files
2025-07-27 03:36:07,140 - INFO - EVA Denoising Dataset initialized:
2025-07-27 03:36:07,140 - INFO -   Directory: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-07-27 03:36:07,141 - INFO -   Mode: patch_only (256 tokens)
2025-07-27 03:36:07,141 - INFO -   TASK: EVA Denoising
2025-07-27 03:36:07,141 - INFO -   INPUT: Noisy EVA embeddings [B, N, 4096]
2025-07-27 03:36:07,141 - INFO -   CONDITIONING: Clean EVA embeddings [B, N, 4096]
2025-07-27 03:36:07,141 - INFO -   TARGET: Clean EVA embeddings [B, N, 4096]
2025-07-27 03:36:07,141 - INFO -   Noise schedule: uniform
2025-07-27 03:36:07,141 - INFO -   Noise range: [0.1, 0.9]
2025-07-27 03:36:07,141 - INFO -   Shards: 1
2025-07-27 03:36:07,141 - INFO - Loaded manifest: 1 shards, 2,646 samples
2025-07-27 03:36:07,141 - INFO - Found 1 files with pattern: embeddings_shard_*_patch_only.pkl
2025-07-27 03:36:07,141 - INFO - Prepared 1 shard files
2025-07-27 03:36:07,141 - INFO - EVA Denoising Dataset initialized:
2025-07-27 03:36:07,141 - INFO -   Directory: /scratch-shared/azadaianchuk1/blip3o_workspace/embeddings/patch_only_256_tokens
2025-07-27 03:36:07,141 - INFO -   Mode: patch_only (256 tokens)
2025-07-27 03:36:07,141 - INFO -   TASK: EVA Denoising
2025-07-27 03:36:07,141 - INFO -   INPUT: Noisy EVA embeddings [B, N, 4096]
2025-07-27 03:36:07,141 - INFO -   CONDITIONING: Clean EVA embeddings [B, N, 4096]
2025-07-27 03:36:07,141 - INFO -   TARGET: Clean EVA embeddings [B, N, 4096]
2025-07-27 03:36:07,141 - INFO -   Noise schedule: uniform
2025-07-27 03:36:07,141 - INFO -   Noise range: [0.3, 0.7]
2025-07-27 03:36:07,141 - INFO -   Shards: 1
2025-07-27 03:36:07,141 - INFO - EVA denoising dataloaders created successfully
2025-07-27 03:36:07,142 - INFO - EVA denoising dataloaders created
2025-07-27 03:36:07,142 - INFO -   Training batches: 330 (estimated)
2025-07-27 03:36:07,142 - INFO -   Evaluation available: True
2025-07-27 03:36:07,142 - INFO - Validating spherical constraints on first batch...
2025-07-27 03:36:12,534 - INFO - Loaded shard 1/1: 2646 samples
2025-07-27 03:36:12,724 - INFO - ‚úÖ Clean EVA embeddings properly normalized: mean norm = 1.0000
2025-07-27 03:36:12,724 - INFO - ‚úÖ Noisy EVA embeddings properly normalized: mean norm = 1.0000
2025-07-27 03:36:12,724 - INFO - ‚úÖ First batch validation successful
2025-07-27 03:36:12,724 - INFO - Creating spherical EVA trainer...
2025-07-27 03:36:12,728 - INFO - Optimizer and scheduler setup complete
2025-07-27 03:36:12,728 - INFO -   Estimated total steps: 3300
2025-07-27 03:36:12,728 - INFO -   Warmup steps: 100
2025-07-27 03:36:12,728 - INFO - Preparing overfitting test with 20 samples...
2025-07-27 03:36:17,924 - INFO - Loaded shard 1/1: 2646 samples
2025-07-27 03:36:18,108 - INFO - Overfitting test prepared with 8 samples
2025-07-27 03:36:18,109 - INFO - Spherical EVA Denoising Trainer initialized
2025-07-27 03:36:18,109 - INFO -   Device: cuda
2025-07-27 03:36:18,109 - INFO -   Task: EVA-CLIP Spherical Denoising
2025-07-27 03:36:18,109 - INFO -   Input: Noisy EVA embeddings [B, N, 4096]
2025-07-27 03:36:18,109 - INFO -   Conditioning: Clean EVA embeddings [B, N, 4096]
2025-07-27 03:36:18,109 - INFO -   Target: Clean EVA embeddings [B, N, 4096]
2025-07-27 03:36:18,109 - INFO -   Learning rate: 0.0005
2025-07-27 03:36:18,109 - INFO -   Epochs: 10
2025-07-27 03:36:18,109 - INFO -   Prediction type: velocity
2025-07-27 03:36:18,109 - INFO -   Overfit test: 20
2025-07-27 03:36:18,109 - INFO -   Mixed precision: True
2025-07-27 03:36:18,109 - INFO - Spherical EVA trainer created
2025-07-27 03:36:18,112 - INFO - Configuration saved to checkpoints/eva_repro_fixed_20250727_033558/experiment_config.json
2025-07-27 03:36:18,112 - INFO - 
üöÄ Starting spherical EVA denoising training...
2025-07-27 03:36:18,112 - INFO - Expected behavior with fixes:
2025-07-27 03:36:18,112 - INFO -   ‚Ä¢ üéØ MAIN GOAL: High cosine similarity (>0.7 excellent, >0.5 good)
2025-07-27 03:36:18,112 - INFO -   ‚Ä¢ ‚¨áÔ∏è Loss should decrease steadily
2025-07-27 03:36:18,112 - INFO -   ‚Ä¢ ‚¨ÜÔ∏è Cosine similarity should increase from ~0 to >0.5+
2025-07-27 03:36:18,112 - INFO -   ‚Ä¢ üîµ Embeddings should stay on unit sphere (norm ‚âà 1.0)
2025-07-27 03:36:18,112 - INFO -   ‚Ä¢ üìà Gradients should be stable and non-zero
2025-07-27 03:36:18,112 - INFO -   ‚Ä¢ üö´ No negative cosine similarities at convergence
2025-07-27 03:36:18,112 - INFO -   ‚Ä¢ üß™ OVERFITTING TEST: Should achieve >0.8 similarity on 20 samples
2025-07-27 03:36:18,112 - INFO - 
2025-07-27 03:36:18,112 - INFO - Starting spherical EVA denoising training...
2025-07-27 03:36:18,113 - INFO -   Model parameters: 212,073,472
2025-07-27 03:36:18,113 - INFO -   Training steps per epoch: 330
2025-07-27 03:36:18,113 - INFO -   Total training steps: 3300
2025-07-27 03:36:18,113 - INFO -   OVERFITTING TEST MODE: Using 8 samples
2025-07-27 03:36:18,115 - INFO - Starting epoch 1/10
2025-07-27 03:36:23,409 - INFO - Loaded shard 1/1: 2646 samples
2025-07-27 03:36:26,485 - INFO - Step 10: Loss=0.000634, PredSim=0.3152, EvalSim=0.7613 (good), SphereViol=0.000000, GradNorm=566.866, LR=9.50e-05 [OVERFIT TEST]
2025-07-27 03:36:26,485 - INFO -   Detailed metrics:
2025-07-27 03:36:26,485 - INFO -     loss: 0.000634
2025-07-27 03:36:26,485 - INFO -     total_loss: 0.000634
2025-07-27 03:36:26,486 - INFO -     reg_loss: 0.000000
2025-07-27 03:36:26,486 - INFO -     prediction_similarity: 0.315216
2025-07-27 03:36:26,486 - INFO -     eval_similarity: 0.761322
2025-07-27 03:36:26,486 - INFO -     similarity_std: 0.060967
2025-07-27 03:36:26,486 - INFO -     sphere_violation: 0.000000
2025-07-27 03:36:26,486 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:36:26,486 - INFO -     pred_norm: 1.095279
2025-07-27 03:36:26,486 - INFO -     target_norm: 1.570915
2025-07-27 03:36:26,486 - INFO -     clean_norm: 1.000000
2025-07-27 03:36:26,486 - INFO -     noise_norm: 1.000000
2025-07-27 03:36:26,486 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:36:26,486 - INFO -     error_norm: 1.608900
2025-07-27 03:36:26,486 - INFO -     relative_error: 1.024180
2025-07-27 03:36:26,486 - INFO -     step_count: 10.000000
2025-07-27 03:36:26,486 - INFO -     loss_ema: 0.003510
2025-07-27 03:36:26,486 - INFO -     similarity_ema: 0.024437
2025-07-27 03:36:26,486 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:36:26,486 - INFO -     timestep_mean: 0.629653
2025-07-27 03:36:26,486 - INFO -     timestep_std: 0.313925
2025-07-27 03:36:26,487 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:36:26,487 - INFO -     pred_min: -0.271973
2025-07-27 03:36:26,487 - INFO -     pred_max: 0.108704
2025-07-27 03:36:26,487 - INFO -     target_min: -1.394262
2025-07-27 03:36:26,487 - INFO -     target_max: 0.844863
2025-07-27 03:36:29,095 - INFO - Step 20: Loss=0.000498, PredSim=0.4321, EvalSim=0.7647 (good), SphereViol=0.000000, GradNorm=403.722, LR=1.40e-04 [OVERFIT TEST]
2025-07-27 03:36:29,096 - INFO -   Detailed metrics:
2025-07-27 03:36:29,096 - INFO -     loss: 0.000498
2025-07-27 03:36:29,096 - INFO -     total_loss: 0.000498
2025-07-27 03:36:29,096 - INFO -     reg_loss: 0.000000
2025-07-27 03:36:29,096 - INFO -     prediction_similarity: 0.432082
2025-07-27 03:36:29,096 - INFO -     eval_similarity: 0.764693
2025-07-27 03:36:29,096 - INFO -     similarity_std: 0.055231
2025-07-27 03:36:29,096 - INFO -     sphere_violation: 0.000000
2025-07-27 03:36:29,096 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:36:29,096 - INFO -     pred_norm: 0.876468
2025-07-27 03:36:29,096 - INFO -     target_norm: 1.570915
2025-07-27 03:36:29,096 - INFO -     clean_norm: 1.000000
2025-07-27 03:36:29,096 - INFO -     noise_norm: 1.000000
2025-07-27 03:36:29,096 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:36:29,096 - INFO -     error_norm: 1.424761
2025-07-27 03:36:29,096 - INFO -     relative_error: 0.906963
2025-07-27 03:36:29,096 - INFO -     step_count: 20.000000
2025-07-27 03:36:29,096 - INFO -     loss_ema: 0.003226
2025-07-27 03:36:29,096 - INFO -     similarity_ema: 0.057883
2025-07-27 03:36:29,096 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:36:29,096 - INFO -     timestep_mean: 0.629653
2025-07-27 03:36:29,097 - INFO -     timestep_std: 0.313925
2025-07-27 03:36:29,097 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:36:29,097 - INFO -     pred_min: -0.188599
2025-07-27 03:36:29,097 - INFO -     pred_max: 0.058167
2025-07-27 03:36:29,097 - INFO -     target_min: -1.394262
2025-07-27 03:36:29,097 - INFO -     target_max: 0.844863
2025-07-27 03:36:31,350 - INFO - Step 30: Loss=0.000411, PredSim=0.5678, EvalSim=0.7719 (good), SphereViol=0.000000, GradNorm=245.252, LR=1.85e-04 [OVERFIT TEST]
2025-07-27 03:36:31,350 - INFO -   Detailed metrics:
2025-07-27 03:36:31,350 - INFO -     loss: 0.000411
2025-07-27 03:36:31,350 - INFO -     total_loss: 0.000411
2025-07-27 03:36:31,350 - INFO -     reg_loss: 0.000000
2025-07-27 03:36:31,350 - INFO -     prediction_similarity: 0.567822
2025-07-27 03:36:31,350 - INFO -     eval_similarity: 0.771855
2025-07-27 03:36:31,350 - INFO -     similarity_std: 0.043558
2025-07-27 03:36:31,350 - INFO -     sphere_violation: 0.000000
2025-07-27 03:36:31,350 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:36:31,350 - INFO -     pred_norm: 1.003781
2025-07-27 03:36:31,350 - INFO -     target_norm: 1.570915
2025-07-27 03:36:31,350 - INFO -     clean_norm: 1.000000
2025-07-27 03:36:31,350 - INFO -     noise_norm: 1.000000
2025-07-27 03:36:31,350 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:36:31,351 - INFO -     error_norm: 1.287565
2025-07-27 03:36:31,351 - INFO -     relative_error: 0.819627
2025-07-27 03:36:31,351 - INFO -     step_count: 30.000000
2025-07-27 03:36:31,351 - INFO -     loss_ema: 0.002961
2025-07-27 03:36:31,351 - INFO -     similarity_ema: 0.101739
2025-07-27 03:36:31,351 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:36:31,351 - INFO -     timestep_mean: 0.629653
2025-07-27 03:36:31,351 - INFO -     timestep_std: 0.313925
2025-07-27 03:36:31,351 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:36:31,351 - INFO -     pred_min: -0.199585
2025-07-27 03:36:31,351 - INFO -     pred_max: 0.061493
2025-07-27 03:36:31,351 - INFO -     target_min: -1.394262
2025-07-27 03:36:31,351 - INFO -     target_max: 0.844863
2025-07-27 03:36:33,788 - INFO - Step 40: Loss=0.000406, PredSim=0.5746, EvalSim=0.7732 (good), SphereViol=0.000000, GradNorm=289.791, LR=2.30e-04 [OVERFIT TEST]
2025-07-27 03:36:33,788 - INFO -   Detailed metrics:
2025-07-27 03:36:33,788 - INFO -     loss: 0.000406
2025-07-27 03:36:33,788 - INFO -     total_loss: 0.000406
2025-07-27 03:36:33,788 - INFO -     reg_loss: 0.000000
2025-07-27 03:36:33,788 - INFO -     prediction_similarity: 0.574558
2025-07-27 03:36:33,788 - INFO -     eval_similarity: 0.773234
2025-07-27 03:36:33,788 - INFO -     similarity_std: 0.056819
2025-07-27 03:36:33,788 - INFO -     sphere_violation: 0.000000
2025-07-27 03:36:33,788 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:36:33,788 - INFO -     pred_norm: 1.032959
2025-07-27 03:36:33,788 - INFO -     target_norm: 1.570915
2025-07-27 03:36:33,788 - INFO -     clean_norm: 1.000000
2025-07-27 03:36:33,788 - INFO -     noise_norm: 1.000000
2025-07-27 03:36:33,788 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:36:33,788 - INFO -     error_norm: 1.278344
2025-07-27 03:36:33,789 - INFO -     relative_error: 0.813758
2025-07-27 03:36:33,789 - INFO -     step_count: 40.000000
2025-07-27 03:36:33,789 - INFO -     loss_ema: 0.002719
2025-07-27 03:36:33,789 - INFO -     similarity_ema: 0.144102
2025-07-27 03:36:33,789 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:36:33,789 - INFO -     timestep_mean: 0.629653
2025-07-27 03:36:33,789 - INFO -     timestep_std: 0.313925
2025-07-27 03:36:33,789 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:36:33,789 - INFO -     pred_min: -0.235718
2025-07-27 03:36:33,789 - INFO -     pred_max: 0.068909
2025-07-27 03:36:33,789 - INFO -     target_min: -1.394262
2025-07-27 03:36:33,789 - INFO -     target_max: 0.844863
2025-07-27 03:36:36,081 - INFO - [Step 50] Spherical Flow Debug:
2025-07-27 03:36:36,081 - INFO -   Loss: 0.000365 (quality: good)
2025-07-27 03:36:36,081 - INFO -   Prediction Sim: 0.6275
2025-07-27 03:36:36,081 - INFO -   Eval Sim: 0.7740
2025-07-27 03:36:36,081 - INFO -   Sphere Violation: 0.000000
2025-07-27 03:36:36,082 - INFO -   Norms - Pred: 1.012, Target: 1.571
2025-07-27 03:36:36,082 - INFO -   Error: 1.210 (relative: 0.770)
2025-07-27 03:36:36,082 - INFO -   Timesteps: 0.630 ¬± 0.314
2025-07-27 03:36:36,156 - INFO - Step 50: Loss=0.000365, PredSim=0.6275, EvalSim=0.7740 (good), SphereViol=0.000000, GradNorm=56.545, LR=2.75e-04 [OVERFIT TEST]
2025-07-27 03:36:36,156 - INFO -   Detailed metrics:
2025-07-27 03:36:36,157 - INFO -     loss: 0.000365
2025-07-27 03:36:36,157 - INFO -     total_loss: 0.000365
2025-07-27 03:36:36,157 - INFO -     reg_loss: 0.000000
2025-07-27 03:36:36,157 - INFO -     prediction_similarity: 0.627543
2025-07-27 03:36:36,157 - INFO -     eval_similarity: 0.773990
2025-07-27 03:36:36,157 - INFO -     similarity_std: 0.035848
2025-07-27 03:36:36,157 - INFO -     sphere_violation: 0.000000
2025-07-27 03:36:36,157 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:36:36,157 - INFO -     pred_norm: 1.012316
2025-07-27 03:36:36,157 - INFO -     target_norm: 1.570915
2025-07-27 03:36:36,157 - INFO -     clean_norm: 1.000000
2025-07-27 03:36:36,157 - INFO -     noise_norm: 1.000000
2025-07-27 03:36:36,157 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:36:36,157 - INFO -     error_norm: 1.210046
2025-07-27 03:36:36,157 - INFO -     relative_error: 0.770281
2025-07-27 03:36:36,157 - INFO -     step_count: 50.000000
2025-07-27 03:36:36,157 - INFO -     loss_ema: 0.002495
2025-07-27 03:36:36,157 - INFO -     similarity_ema: 0.189059
2025-07-27 03:36:36,157 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:36:36,157 - INFO -     timestep_mean: 0.629653
2025-07-27 03:36:36,157 - INFO -     timestep_std: 0.313925
2025-07-27 03:36:36,157 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:36:36,157 - INFO -     pred_min: -0.203369
2025-07-27 03:36:36,157 - INFO -     pred_max: 0.101807
2025-07-27 03:36:36,157 - INFO -     target_min: -1.394262
2025-07-27 03:36:36,157 - INFO -     target_max: 0.844863
2025-07-27 03:36:38,595 - INFO - Step 60: Loss=0.000358, PredSim=0.6368, EvalSim=0.7742 (good), SphereViol=0.000000, GradNorm=32.311, LR=3.20e-04 [OVERFIT TEST]
2025-07-27 03:36:38,595 - INFO -   Detailed metrics:
2025-07-27 03:36:38,595 - INFO -     loss: 0.000358
2025-07-27 03:36:38,595 - INFO -     total_loss: 0.000358
2025-07-27 03:36:38,595 - INFO -     reg_loss: 0.000000
2025-07-27 03:36:38,595 - INFO -     prediction_similarity: 0.636763
2025-07-27 03:36:38,595 - INFO -     eval_similarity: 0.774190
2025-07-27 03:36:38,595 - INFO -     similarity_std: 0.036268
2025-07-27 03:36:38,595 - INFO -     sphere_violation: 0.000000
2025-07-27 03:36:38,595 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:36:38,595 - INFO -     pred_norm: 1.006687
2025-07-27 03:36:38,595 - INFO -     target_norm: 1.570915
2025-07-27 03:36:38,595 - INFO -     clean_norm: 1.000000
2025-07-27 03:36:38,596 - INFO -     noise_norm: 1.000000
2025-07-27 03:36:38,596 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:36:38,596 - INFO -     error_norm: 1.197108
2025-07-27 03:36:38,596 - INFO -     relative_error: 0.762045
2025-07-27 03:36:38,596 - INFO -     step_count: 60.000000
2025-07-27 03:36:38,596 - INFO -     loss_ema: 0.002291
2025-07-27 03:36:38,596 - INFO -     similarity_ema: 0.231685
2025-07-27 03:36:38,596 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:36:38,596 - INFO -     timestep_mean: 0.629653
2025-07-27 03:36:38,596 - INFO -     timestep_std: 0.313925
2025-07-27 03:36:38,596 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:36:38,596 - INFO -     pred_min: -0.237915
2025-07-27 03:36:38,596 - INFO -     pred_max: 0.117981
2025-07-27 03:36:38,596 - INFO -     target_min: -1.394262
2025-07-27 03:36:38,596 - INFO -     target_max: 0.844863
2025-07-27 03:36:40,941 - INFO - Step 70: Loss=0.000356, PredSim=0.6396, EvalSim=0.7748 (good), SphereViol=0.000000, GradNorm=28.636, LR=3.65e-04 [OVERFIT TEST]
2025-07-27 03:36:40,941 - INFO -   Detailed metrics:
2025-07-27 03:36:40,941 - INFO -     loss: 0.000356
2025-07-27 03:36:40,941 - INFO -     total_loss: 0.000356
2025-07-27 03:36:40,941 - INFO -     reg_loss: 0.000000
2025-07-27 03:36:40,941 - INFO -     prediction_similarity: 0.639596
2025-07-27 03:36:40,941 - INFO -     eval_similarity: 0.774800
2025-07-27 03:36:40,941 - INFO -     similarity_std: 0.036483
2025-07-27 03:36:40,941 - INFO -     sphere_violation: 0.000000
2025-07-27 03:36:40,941 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:36:40,941 - INFO -     pred_norm: 1.058025
2025-07-27 03:36:40,941 - INFO -     target_norm: 1.570915
2025-07-27 03:36:40,941 - INFO -     clean_norm: 1.000000
2025-07-27 03:36:40,941 - INFO -     noise_norm: 1.000000
2025-07-27 03:36:40,941 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:36:40,941 - INFO -     error_norm: 1.192566
2025-07-27 03:36:40,941 - INFO -     relative_error: 0.759154
2025-07-27 03:36:40,941 - INFO -     step_count: 70.000000
2025-07-27 03:36:40,941 - INFO -     loss_ema: 0.002106
2025-07-27 03:36:40,941 - INFO -     similarity_ema: 0.270602
2025-07-27 03:36:40,941 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:36:40,941 - INFO -     timestep_mean: 0.629653
2025-07-27 03:36:40,941 - INFO -     timestep_std: 0.313925
2025-07-27 03:36:40,942 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:36:40,942 - INFO -     pred_min: -0.275146
2025-07-27 03:36:40,942 - INFO -     pred_max: 0.137573
2025-07-27 03:36:40,942 - INFO -     target_min: -1.394262
2025-07-27 03:36:40,942 - INFO -     target_max: 0.844863
2025-07-27 03:36:43,442 - INFO - Step 80: Loss=0.000357, PredSim=0.6387, EvalSim=0.7735 (good), SphereViol=0.000000, GradNorm=31.676, LR=4.10e-04 [OVERFIT TEST]
2025-07-27 03:36:43,442 - INFO -   Detailed metrics:
2025-07-27 03:36:43,443 - INFO -     loss: 0.000357
2025-07-27 03:36:43,443 - INFO -     total_loss: 0.000357
2025-07-27 03:36:43,443 - INFO -     reg_loss: 0.000000
2025-07-27 03:36:43,443 - INFO -     prediction_similarity: 0.638728
2025-07-27 03:36:43,443 - INFO -     eval_similarity: 0.773462
2025-07-27 03:36:43,443 - INFO -     similarity_std: 0.036906
2025-07-27 03:36:43,443 - INFO -     sphere_violation: 0.000000
2025-07-27 03:36:43,443 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:36:43,443 - INFO -     pred_norm: 0.947393
2025-07-27 03:36:43,443 - INFO -     target_norm: 1.570915
2025-07-27 03:36:43,443 - INFO -     clean_norm: 1.000000
2025-07-27 03:36:43,443 - INFO -     noise_norm: 1.000000
2025-07-27 03:36:43,443 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:36:43,443 - INFO -     error_norm: 1.196552
2025-07-27 03:36:43,443 - INFO -     relative_error: 0.761691
2025-07-27 03:36:43,443 - INFO -     step_count: 80.000000
2025-07-27 03:36:43,443 - INFO -     loss_ema: 0.001938
2025-07-27 03:36:43,443 - INFO -     similarity_ema: 0.306030
2025-07-27 03:36:43,443 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:36:43,443 - INFO -     timestep_mean: 0.629653
2025-07-27 03:36:43,443 - INFO -     timestep_std: 0.313925
2025-07-27 03:36:43,443 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:36:43,443 - INFO -     pred_min: -0.257324
2025-07-27 03:36:43,443 - INFO -     pred_max: 0.139526
2025-07-27 03:36:43,443 - INFO -     target_min: -1.394262
2025-07-27 03:36:43,443 - INFO -     target_max: 0.844863
2025-07-27 03:36:45,921 - INFO - Step 90: Loss=0.000358, PredSim=0.6364, EvalSim=0.7738 (good), SphereViol=0.000000, GradNorm=34.594, LR=4.55e-04 [OVERFIT TEST]
2025-07-27 03:36:45,921 - INFO -   Detailed metrics:
2025-07-27 03:36:45,921 - INFO -     loss: 0.000358
2025-07-27 03:36:45,921 - INFO -     total_loss: 0.000358
2025-07-27 03:36:45,921 - INFO -     reg_loss: 0.000000
2025-07-27 03:36:45,921 - INFO -     prediction_similarity: 0.636394
2025-07-27 03:36:45,921 - INFO -     eval_similarity: 0.773765
2025-07-27 03:36:45,922 - INFO -     similarity_std: 0.037269
2025-07-27 03:36:45,922 - INFO -     sphere_violation: 0.000000
2025-07-27 03:36:45,922 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:36:45,922 - INFO -     pred_norm: 0.990589
2025-07-27 03:36:45,922 - INFO -     target_norm: 1.570915
2025-07-27 03:36:45,922 - INFO -     clean_norm: 1.000000
2025-07-27 03:36:45,922 - INFO -     noise_norm: 1.000000
2025-07-27 03:36:45,922 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:36:45,922 - INFO -     error_norm: 1.197931
2025-07-27 03:36:45,922 - INFO -     relative_error: 0.762569
2025-07-27 03:36:45,922 - INFO -     step_count: 90.000000
2025-07-27 03:36:45,922 - INFO -     loss_ema: 0.001787
2025-07-27 03:36:45,922 - INFO -     similarity_ema: 0.337633
2025-07-27 03:36:45,922 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:36:45,922 - INFO -     timestep_mean: 0.629653
2025-07-27 03:36:45,922 - INFO -     timestep_std: 0.313925
2025-07-27 03:36:45,922 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:36:45,922 - INFO -     pred_min: -0.255127
2025-07-27 03:36:45,922 - INFO -     pred_max: 0.135864
2025-07-27 03:36:45,922 - INFO -     target_min: -1.394262
2025-07-27 03:36:45,922 - INFO -     target_max: 0.844863
2025-07-27 03:36:48,234 - INFO - [Step 100] Spherical Flow Debug:
2025-07-27 03:36:48,234 - INFO -   Loss: 0.000355 (quality: good)
2025-07-27 03:36:48,234 - INFO -   Prediction Sim: 0.6405
2025-07-27 03:36:48,234 - INFO -   Eval Sim: 0.7746
2025-07-27 03:36:48,235 - INFO -   Sphere Violation: 0.000000
2025-07-27 03:36:48,235 - INFO -   Norms - Pred: 1.027, Target: 1.571
2025-07-27 03:36:48,235 - INFO -   Error: 1.191 (relative: 0.758)
2025-07-27 03:36:48,235 - INFO -   Timesteps: 0.630 ¬± 0.314
2025-07-27 03:36:48,310 - INFO - Step 100: Loss=0.000355, PredSim=0.6405, EvalSim=0.7746 (good), SphereViol=0.000000, GradNorm=23.078, LR=5.00e-04 [OVERFIT TEST]
2025-07-27 03:36:48,310 - INFO -   Detailed metrics:
2025-07-27 03:36:48,310 - INFO -     loss: 0.000355
2025-07-27 03:36:48,311 - INFO -     total_loss: 0.000355
2025-07-27 03:36:48,311 - INFO -     reg_loss: 0.000000
2025-07-27 03:36:48,311 - INFO -     prediction_similarity: 0.640504
2025-07-27 03:36:48,311 - INFO -     eval_similarity: 0.774580
2025-07-27 03:36:48,311 - INFO -     similarity_std: 0.036354
2025-07-27 03:36:48,311 - INFO -     sphere_violation: 0.000000
2025-07-27 03:36:48,311 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:36:48,311 - INFO -     pred_norm: 1.026799
2025-07-27 03:36:48,311 - INFO -     target_norm: 1.570915
2025-07-27 03:36:48,311 - INFO -     clean_norm: 1.000000
2025-07-27 03:36:48,311 - INFO -     noise_norm: 1.000000
2025-07-27 03:36:48,311 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:36:48,311 - INFO -     error_norm: 1.191393
2025-07-27 03:36:48,311 - INFO -     relative_error: 0.758407
2025-07-27 03:36:48,311 - INFO -     step_count: 100.000000
2025-07-27 03:36:48,311 - INFO -     loss_ema: 0.001651
2025-07-27 03:36:48,311 - INFO -     similarity_ema: 0.366501
2025-07-27 03:36:48,311 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:36:48,311 - INFO -     timestep_mean: 0.629653
2025-07-27 03:36:48,311 - INFO -     timestep_std: 0.313925
2025-07-27 03:36:48,311 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:36:48,311 - INFO -     pred_min: -0.264404
2025-07-27 03:36:48,311 - INFO -     pred_max: 0.131226
2025-07-27 03:36:48,311 - INFO -     target_min: -1.394262
2025-07-27 03:36:48,311 - INFO -     target_max: 0.844863
2025-07-27 03:36:48,311 - INFO - Running evaluation at step 100...
2025-07-27 03:36:53,891 - INFO - Loaded shard 1/1: 2646 samples
2025-07-27 03:38:31,288 - INFO - Evaluation results:
2025-07-27 03:38:31,288 - INFO -   eval_eva_similarity: 0.6334
2025-07-27 03:38:31,288 - INFO -   eval_eva_similarity_std: 0.0895
2025-07-27 03:38:31,288 - INFO -   eval_angular_distance: 0.8791
2025-07-27 03:38:31,288 - INFO -   eval_sphere_violation: 0.0000
2025-07-27 03:38:31,288 - INFO -   eval_high_quality: 0.3016
2025-07-27 03:38:31,288 - INFO -   eval_very_high_quality: 0.0000
2025-07-27 03:38:31,289 - INFO -   eval_excellent_quality: 0.0000
2025-07-27 03:38:31,289 - INFO -   eval_samples: 504.0000
2025-07-27 03:38:31,289 - INFO -   eval_similarity_min: 0.4351
2025-07-27 03:38:31,289 - INFO -   eval_similarity_max: 0.7851
2025-07-27 03:38:33,873 - INFO - Step 110: Loss=0.000352, PredSim=0.6440, EvalSim=0.7746 (good), SphereViol=0.000000, GradNorm=9.185, LR=5.00e-04 [OVERFIT TEST]
2025-07-27 03:38:33,873 - INFO -   Detailed metrics:
2025-07-27 03:38:33,873 - INFO -     loss: 0.000352
2025-07-27 03:38:33,873 - INFO -     total_loss: 0.000352
2025-07-27 03:38:33,873 - INFO -     reg_loss: 0.000000
2025-07-27 03:38:33,873 - INFO -     prediction_similarity: 0.643957
2025-07-27 03:38:33,873 - INFO -     eval_similarity: 0.774637
2025-07-27 03:38:33,873 - INFO -     similarity_std: 0.036397
2025-07-27 03:38:33,873 - INFO -     sphere_violation: 0.000000
2025-07-27 03:38:33,873 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:38:33,873 - INFO -     pred_norm: 1.019763
2025-07-27 03:38:33,873 - INFO -     target_norm: 1.570915
2025-07-27 03:38:33,873 - INFO -     clean_norm: 1.000000
2025-07-27 03:38:33,873 - INFO -     noise_norm: 1.000000
2025-07-27 03:38:33,873 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:38:33,873 - INFO -     error_norm: 1.185448
2025-07-27 03:38:33,873 - INFO -     relative_error: 0.754623
2025-07-27 03:38:33,873 - INFO -     step_count: 110.000000
2025-07-27 03:38:33,873 - INFO -     loss_ema: 0.001526
2025-07-27 03:38:33,873 - INFO -     similarity_ema: 0.392942
2025-07-27 03:38:33,873 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:38:33,873 - INFO -     timestep_mean: 0.629653
2025-07-27 03:38:33,873 - INFO -     timestep_std: 0.313925
2025-07-27 03:38:33,873 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:38:33,874 - INFO -     pred_min: -0.269043
2025-07-27 03:38:33,874 - INFO -     pred_max: 0.125610
2025-07-27 03:38:33,874 - INFO -     target_min: -1.394262
2025-07-27 03:38:33,874 - INFO -     target_max: 0.844863
2025-07-27 03:38:36,221 - INFO - Step 120: Loss=0.000354, PredSim=0.6411, EvalSim=0.7732 (good), SphereViol=0.000000, GradNorm=26.404, LR=5.00e-04 [OVERFIT TEST]
2025-07-27 03:38:36,221 - INFO -   Detailed metrics:
2025-07-27 03:38:36,221 - INFO -     loss: 0.000354
2025-07-27 03:38:36,221 - INFO -     total_loss: 0.000354
2025-07-27 03:38:36,221 - INFO -     reg_loss: 0.000000
2025-07-27 03:38:36,222 - INFO -     prediction_similarity: 0.641133
2025-07-27 03:38:36,222 - INFO -     eval_similarity: 0.773206
2025-07-27 03:38:36,222 - INFO -     similarity_std: 0.038215
2025-07-27 03:38:36,222 - INFO -     sphere_violation: 0.000000
2025-07-27 03:38:36,222 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:38:36,222 - INFO -     pred_norm: 0.984588
2025-07-27 03:38:36,222 - INFO -     target_norm: 1.570915
2025-07-27 03:38:36,222 - INFO -     clean_norm: 1.000000
2025-07-27 03:38:36,222 - INFO -     noise_norm: 1.000000
2025-07-27 03:38:36,222 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:38:36,222 - INFO -     error_norm: 1.190679
2025-07-27 03:38:36,222 - INFO -     relative_error: 0.757953
2025-07-27 03:38:36,222 - INFO -     step_count: 120.000000
2025-07-27 03:38:36,222 - INFO -     loss_ema: 0.001414
2025-07-27 03:38:36,222 - INFO -     similarity_ema: 0.416652
2025-07-27 03:38:36,222 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:38:36,222 - INFO -     timestep_mean: 0.629653
2025-07-27 03:38:36,222 - INFO -     timestep_std: 0.313925
2025-07-27 03:38:36,222 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:38:36,222 - INFO -     pred_min: -0.270264
2025-07-27 03:38:36,222 - INFO -     pred_max: 0.121155
2025-07-27 03:38:36,222 - INFO -     target_min: -1.394262
2025-07-27 03:38:36,222 - INFO -     target_max: 0.844863
2025-07-27 03:38:38,746 - INFO - Step 130: Loss=0.000328, PredSim=0.6754, EvalSim=0.7760 (good), SphereViol=0.000000, GradNorm=12.934, LR=5.00e-04 [OVERFIT TEST]
2025-07-27 03:38:38,746 - INFO -   Detailed metrics:
2025-07-27 03:38:38,746 - INFO -     loss: 0.000328
2025-07-27 03:38:38,747 - INFO -     total_loss: 0.000328
2025-07-27 03:38:38,747 - INFO -     reg_loss: 0.000000
2025-07-27 03:38:38,747 - INFO -     prediction_similarity: 0.675422
2025-07-27 03:38:38,747 - INFO -     eval_similarity: 0.775974
2025-07-27 03:38:38,747 - INFO -     similarity_std: 0.040203
2025-07-27 03:38:38,747 - INFO -     sphere_violation: 0.000000
2025-07-27 03:38:38,747 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:38:38,747 - INFO -     pred_norm: 1.066154
2025-07-27 03:38:38,747 - INFO -     target_norm: 1.570915
2025-07-27 03:38:38,747 - INFO -     clean_norm: 1.000000
2025-07-27 03:38:38,747 - INFO -     noise_norm: 1.000000
2025-07-27 03:38:38,747 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:38:38,747 - INFO -     error_norm: 1.148330
2025-07-27 03:38:38,747 - INFO -     relative_error: 0.730994
2025-07-27 03:38:38,747 - INFO -     step_count: 130.000000
2025-07-27 03:38:38,747 - INFO -     loss_ema: 0.001312
2025-07-27 03:38:38,747 - INFO -     similarity_ema: 0.439870
2025-07-27 03:38:38,747 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:38:38,747 - INFO -     timestep_mean: 0.629653
2025-07-27 03:38:38,747 - INFO -     timestep_std: 0.313925
2025-07-27 03:38:38,747 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:38:38,747 - INFO -     pred_min: -0.354736
2025-07-27 03:38:38,747 - INFO -     pred_max: 0.421143
2025-07-27 03:38:38,747 - INFO -     target_min: -1.394262
2025-07-27 03:38:38,747 - INFO -     target_max: 0.844863
2025-07-27 03:38:41,154 - INFO - Step 140: Loss=0.000327, PredSim=0.6774, EvalSim=0.7771 (good), SphereViol=0.000000, GradNorm=34.072, LR=5.00e-04 [OVERFIT TEST]
2025-07-27 03:38:41,154 - INFO -   Detailed metrics:
2025-07-27 03:38:41,154 - INFO -     loss: 0.000327
2025-07-27 03:38:41,154 - INFO -     total_loss: 0.000327
2025-07-27 03:38:41,154 - INFO -     reg_loss: 0.000000
2025-07-27 03:38:41,154 - INFO -     prediction_similarity: 0.677373
2025-07-27 03:38:41,155 - INFO -     eval_similarity: 0.777055
2025-07-27 03:38:41,155 - INFO -     similarity_std: 0.039993
2025-07-27 03:38:41,155 - INFO -     sphere_violation: 0.000000
2025-07-27 03:38:41,155 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:38:41,155 - INFO -     pred_norm: 1.125219
2025-07-27 03:38:41,155 - INFO -     target_norm: 1.570915
2025-07-27 03:38:41,155 - INFO -     clean_norm: 1.000000
2025-07-27 03:38:41,155 - INFO -     noise_norm: 1.000000
2025-07-27 03:38:41,155 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:38:41,155 - INFO -     error_norm: 1.146986
2025-07-27 03:38:41,155 - INFO -     relative_error: 0.730139
2025-07-27 03:38:41,155 - INFO -     step_count: 140.000000
2025-07-27 03:38:41,155 - INFO -     loss_ema: 0.001219
2025-07-27 03:38:41,155 - INFO -     similarity_ema: 0.460868
2025-07-27 03:38:41,155 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:38:41,155 - INFO -     timestep_mean: 0.629653
2025-07-27 03:38:41,155 - INFO -     timestep_std: 0.313925
2025-07-27 03:38:41,155 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:38:41,155 - INFO -     pred_min: -0.500977
2025-07-27 03:38:41,155 - INFO -     pred_max: 0.589844
2025-07-27 03:38:41,156 - INFO -     target_min: -1.394262
2025-07-27 03:38:41,156 - INFO -     target_max: 0.844863
2025-07-27 03:38:43,552 - INFO - [Step 150] Spherical Flow Debug:
2025-07-27 03:38:43,552 - INFO -   Loss: 0.000308 (quality: good)
2025-07-27 03:38:43,552 - INFO -   Prediction Sim: 0.6978
2025-07-27 03:38:43,552 - INFO -   Eval Sim: 0.7773
2025-07-27 03:38:43,552 - INFO -   Sphere Violation: 0.000000
2025-07-27 03:38:43,552 - INFO -   Norms - Pred: 1.094, Target: 1.571
2025-07-27 03:38:43,553 - INFO -   Error: 1.115 (relative: 0.710)
2025-07-27 03:38:43,553 - INFO -   Timesteps: 0.630 ¬± 0.314
2025-07-27 03:38:43,628 - INFO - Step 150: Loss=0.000308, PredSim=0.6978, EvalSim=0.7773 (good), SphereViol=0.000000, GradNorm=57.862, LR=5.00e-04 [OVERFIT TEST]
2025-07-27 03:38:43,628 - INFO -   Detailed metrics:
2025-07-27 03:38:43,628 - INFO -     loss: 0.000308
2025-07-27 03:38:43,629 - INFO -     total_loss: 0.000308
2025-07-27 03:38:43,629 - INFO -     reg_loss: 0.000000
2025-07-27 03:38:43,629 - INFO -     prediction_similarity: 0.697795
2025-07-27 03:38:43,629 - INFO -     eval_similarity: 0.777323
2025-07-27 03:38:43,629 - INFO -     similarity_std: 0.030629
2025-07-27 03:38:43,629 - INFO -     sphere_violation: 0.000000
2025-07-27 03:38:43,629 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:38:43,629 - INFO -     pred_norm: 1.093785
2025-07-27 03:38:43,629 - INFO -     target_norm: 1.570915
2025-07-27 03:38:43,629 - INFO -     clean_norm: 1.000000
2025-07-27 03:38:43,629 - INFO -     noise_norm: 1.000000
2025-07-27 03:38:43,629 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:38:43,629 - INFO -     error_norm: 1.114991
2025-07-27 03:38:43,629 - INFO -     relative_error: 0.709772
2025-07-27 03:38:43,629 - INFO -     step_count: 150.000000
2025-07-27 03:38:43,629 - INFO -     loss_ema: 0.001134
2025-07-27 03:38:43,629 - INFO -     similarity_ema: 0.481425
2025-07-27 03:38:43,629 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:38:43,629 - INFO -     timestep_mean: 0.629653
2025-07-27 03:38:43,629 - INFO -     timestep_std: 0.313925
2025-07-27 03:38:43,629 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:38:43,629 - INFO -     pred_min: -0.558594
2025-07-27 03:38:43,629 - INFO -     pred_max: 0.733398
2025-07-27 03:38:43,629 - INFO -     target_min: -1.394262
2025-07-27 03:38:43,629 - INFO -     target_max: 0.844863
2025-07-27 03:38:45,987 - INFO - Step 160: Loss=0.000259, PredSim=0.7535, EvalSim=0.7805 (good), SphereViol=0.000000, GradNorm=21.185, LR=5.00e-04 [OVERFIT TEST]
2025-07-27 03:38:45,987 - INFO -   Detailed metrics:
2025-07-27 03:38:45,987 - INFO -     loss: 0.000259
2025-07-27 03:38:45,987 - INFO -     total_loss: 0.000259
2025-07-27 03:38:45,987 - INFO -     reg_loss: 0.000000
2025-07-27 03:38:45,987 - INFO -     prediction_similarity: 0.753541
2025-07-27 03:38:45,988 - INFO -     eval_similarity: 0.780490
2025-07-27 03:38:45,988 - INFO -     similarity_std: 0.035973
2025-07-27 03:38:45,988 - INFO -     sphere_violation: 0.000000
2025-07-27 03:38:45,988 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:38:45,988 - INFO -     pred_norm: 1.170635
2025-07-27 03:38:45,988 - INFO -     target_norm: 1.570915
2025-07-27 03:38:45,988 - INFO -     clean_norm: 1.000000
2025-07-27 03:38:45,988 - INFO -     noise_norm: 1.000000
2025-07-27 03:38:45,988 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:38:45,988 - INFO -     error_norm: 1.017459
2025-07-27 03:38:45,988 - INFO -     relative_error: 0.647686
2025-07-27 03:38:45,988 - INFO -     step_count: 160.000000
2025-07-27 03:38:45,988 - INFO -     loss_ema: 0.001052
2025-07-27 03:38:45,988 - INFO -     similarity_ema: 0.505324
2025-07-27 03:38:45,988 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:38:45,988 - INFO -     timestep_mean: 0.629653
2025-07-27 03:38:45,988 - INFO -     timestep_std: 0.313925
2025-07-27 03:38:45,988 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:38:45,988 - INFO -     pred_min: -1.239258
2025-07-27 03:38:45,988 - INFO -     pred_max: 0.855957
2025-07-27 03:38:45,989 - INFO -     target_min: -1.394262
2025-07-27 03:38:45,989 - INFO -     target_max: 0.844863
2025-07-27 03:38:48,546 - INFO - Step 170: Loss=0.000235, PredSim=0.7788, EvalSim=0.7832 (good), SphereViol=0.000000, GradNorm=10.606, LR=4.99e-04 [OVERFIT TEST]
2025-07-27 03:38:48,546 - INFO -   Detailed metrics:
2025-07-27 03:38:48,546 - INFO -     loss: 0.000235
2025-07-27 03:38:48,547 - INFO -     total_loss: 0.000235
2025-07-27 03:38:48,547 - INFO -     reg_loss: 0.000000
2025-07-27 03:38:48,547 - INFO -     prediction_similarity: 0.778770
2025-07-27 03:38:48,547 - INFO -     eval_similarity: 0.783216
2025-07-27 03:38:48,547 - INFO -     similarity_std: 0.036283
2025-07-27 03:38:48,547 - INFO -     sphere_violation: 0.000000
2025-07-27 03:38:48,547 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:38:48,547 - INFO -     pred_norm: 1.253194
2025-07-27 03:38:48,547 - INFO -     target_norm: 1.570915
2025-07-27 03:38:48,547 - INFO -     clean_norm: 1.000000
2025-07-27 03:38:48,547 - INFO -     noise_norm: 1.000000
2025-07-27 03:38:48,547 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:38:48,547 - INFO -     error_norm: 0.963537
2025-07-27 03:38:48,547 - INFO -     relative_error: 0.613360
2025-07-27 03:38:48,547 - INFO -     step_count: 170.000000
2025-07-27 03:38:48,547 - INFO -     loss_ema: 0.000975
2025-07-27 03:38:48,547 - INFO -     similarity_ema: 0.530532
2025-07-27 03:38:48,547 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:38:48,547 - INFO -     timestep_mean: 0.629653
2025-07-27 03:38:48,548 - INFO -     timestep_std: 0.313925
2025-07-27 03:38:48,548 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:38:48,548 - INFO -     pred_min: -1.520508
2025-07-27 03:38:48,548 - INFO -     pred_max: 0.762207
2025-07-27 03:38:48,548 - INFO -     target_min: -1.394262
2025-07-27 03:38:48,548 - INFO -     target_max: 0.844863
2025-07-27 03:38:51,062 - INFO - Step 180: Loss=0.000230, PredSim=0.7843, EvalSim=0.7844 (good), SphereViol=0.000000, GradNorm=41.490, LR=4.99e-04 [OVERFIT TEST]
2025-07-27 03:38:51,062 - INFO -   Detailed metrics:
2025-07-27 03:38:51,062 - INFO -     loss: 0.000230
2025-07-27 03:38:51,062 - INFO -     total_loss: 0.000230
2025-07-27 03:38:51,062 - INFO -     reg_loss: 0.000000
2025-07-27 03:38:51,063 - INFO -     prediction_similarity: 0.784271
2025-07-27 03:38:51,063 - INFO -     eval_similarity: 0.784436
2025-07-27 03:38:51,063 - INFO -     similarity_std: 0.032401
2025-07-27 03:38:51,063 - INFO -     sphere_violation: 0.000000
2025-07-27 03:38:51,063 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:38:51,063 - INFO -     pred_norm: 1.289185
2025-07-27 03:38:51,063 - INFO -     target_norm: 1.570915
2025-07-27 03:38:51,063 - INFO -     clean_norm: 1.000000
2025-07-27 03:38:51,063 - INFO -     noise_norm: 1.000000
2025-07-27 03:38:51,063 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:38:51,063 - INFO -     error_norm: 0.953074
2025-07-27 03:38:51,063 - INFO -     relative_error: 0.606700
2025-07-27 03:38:51,063 - INFO -     step_count: 180.000000
2025-07-27 03:38:51,063 - INFO -     loss_ema: 0.000904
2025-07-27 03:38:51,063 - INFO -     similarity_ema: 0.554659
2025-07-27 03:38:51,063 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:38:51,063 - INFO -     timestep_mean: 0.629653
2025-07-27 03:38:51,063 - INFO -     timestep_std: 0.313925
2025-07-27 03:38:51,063 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:38:51,063 - INFO -     pred_min: -1.382812
2025-07-27 03:38:51,063 - INFO -     pred_max: 0.702637
2025-07-27 03:38:51,063 - INFO -     target_min: -1.394262
2025-07-27 03:38:51,063 - INFO -     target_max: 0.844863
2025-07-27 03:38:53,626 - INFO - Step 190: Loss=0.000205, PredSim=0.8091, EvalSim=0.7853 (good), SphereViol=0.000000, GradNorm=9.953, LR=4.99e-04 [OVERFIT TEST]
2025-07-27 03:38:53,626 - INFO -   Detailed metrics:
2025-07-27 03:38:53,626 - INFO -     loss: 0.000205
2025-07-27 03:38:53,626 - INFO -     total_loss: 0.000205
2025-07-27 03:38:53,626 - INFO -     reg_loss: 0.000000
2025-07-27 03:38:53,626 - INFO -     prediction_similarity: 0.809055
2025-07-27 03:38:53,626 - INFO -     eval_similarity: 0.785257
2025-07-27 03:38:53,626 - INFO -     similarity_std: 0.030532
2025-07-27 03:38:53,626 - INFO -     sphere_violation: 0.000000
2025-07-27 03:38:53,626 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:38:53,627 - INFO -     pred_norm: 1.270175
2025-07-27 03:38:53,627 - INFO -     target_norm: 1.570915
2025-07-27 03:38:53,627 - INFO -     clean_norm: 1.000000
2025-07-27 03:38:53,627 - INFO -     noise_norm: 1.000000
2025-07-27 03:38:53,627 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:38:53,627 - INFO -     error_norm: 0.895431
2025-07-27 03:38:53,627 - INFO -     relative_error: 0.570006
2025-07-27 03:38:53,627 - INFO -     step_count: 190.000000
2025-07-27 03:38:53,627 - INFO -     loss_ema: 0.000838
2025-07-27 03:38:53,627 - INFO -     similarity_ema: 0.578241
2025-07-27 03:38:53,627 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:38:53,627 - INFO -     timestep_mean: 0.629653
2025-07-27 03:38:53,627 - INFO -     timestep_std: 0.313925
2025-07-27 03:38:53,627 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:38:53,627 - INFO -     pred_min: -1.366211
2025-07-27 03:38:53,627 - INFO -     pred_max: 0.755371
2025-07-27 03:38:53,627 - INFO -     target_min: -1.394262
2025-07-27 03:38:53,628 - INFO -     target_max: 0.844863
2025-07-27 03:38:56,219 - INFO - [Step 200] Spherical Flow Debug:
2025-07-27 03:38:56,220 - INFO -   Loss: 0.000194 (quality: good)
2025-07-27 03:38:56,220 - INFO -   Prediction Sim: 0.8209
2025-07-27 03:38:56,220 - INFO -   Eval Sim: 0.7874
2025-07-27 03:38:56,220 - INFO -   Sphere Violation: 0.000000
2025-07-27 03:38:56,220 - INFO -   Norms - Pred: 1.344, Target: 1.571
2025-07-27 03:38:56,220 - INFO -   Error: 0.871 (relative: 0.555)
2025-07-27 03:38:56,220 - INFO -   Timesteps: 0.630 ¬± 0.314
2025-07-27 03:38:56,296 - INFO - Step 200: Loss=0.000194, PredSim=0.8209, EvalSim=0.7874 (good), SphereViol=0.000000, GradNorm=30.255, LR=4.99e-04 [OVERFIT TEST]
2025-07-27 03:38:56,297 - INFO -   Detailed metrics:
2025-07-27 03:38:56,297 - INFO -     loss: 0.000194
2025-07-27 03:38:56,297 - INFO -     total_loss: 0.000194
2025-07-27 03:38:56,297 - INFO -     reg_loss: 0.000000
2025-07-27 03:38:56,297 - INFO -     prediction_similarity: 0.820858
2025-07-27 03:38:56,297 - INFO -     eval_similarity: 0.787415
2025-07-27 03:38:56,297 - INFO -     similarity_std: 0.030442
2025-07-27 03:38:56,297 - INFO -     sphere_violation: 0.000000
2025-07-27 03:38:56,297 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:38:56,297 - INFO -     pred_norm: 1.344170
2025-07-27 03:38:56,297 - INFO -     target_norm: 1.570915
2025-07-27 03:38:56,297 - INFO -     clean_norm: 1.000000
2025-07-27 03:38:56,297 - INFO -     noise_norm: 1.000000
2025-07-27 03:38:56,297 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:38:56,297 - INFO -     error_norm: 0.871082
2025-07-27 03:38:56,298 - INFO -     relative_error: 0.554506
2025-07-27 03:38:56,298 - INFO -     step_count: 200.000000
2025-07-27 03:38:56,298 - INFO -     loss_ema: 0.000776
2025-07-27 03:38:56,298 - INFO -     similarity_ema: 0.601127
2025-07-27 03:38:56,298 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:38:56,298 - INFO -     timestep_mean: 0.629653
2025-07-27 03:38:56,298 - INFO -     timestep_std: 0.313925
2025-07-27 03:38:56,298 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:38:56,298 - INFO -     pred_min: -1.404297
2025-07-27 03:38:56,298 - INFO -     pred_max: 0.835938
2025-07-27 03:38:56,298 - INFO -     target_min: -1.394262
2025-07-27 03:38:56,298 - INFO -     target_max: 0.844863
2025-07-27 03:38:56,298 - INFO - Running evaluation at step 200...
2025-07-27 03:39:02,051 - INFO - Loaded shard 1/1: 2646 samples
2025-07-27 03:40:38,496 - INFO - Evaluation results:
2025-07-27 03:40:38,497 - INFO -   eval_eva_similarity: 0.6187
2025-07-27 03:40:38,497 - INFO -   eval_eva_similarity_std: 0.0623
2025-07-27 03:40:38,497 - INFO -   eval_angular_distance: 0.8961
2025-07-27 03:40:38,497 - INFO -   eval_sphere_violation: 0.0000
2025-07-27 03:40:38,497 - INFO -   eval_high_quality: 0.0893
2025-07-27 03:40:38,497 - INFO -   eval_very_high_quality: 0.0000
2025-07-27 03:40:38,497 - INFO -   eval_excellent_quality: 0.0000
2025-07-27 03:40:38,497 - INFO -   eval_samples: 504.0000
2025-07-27 03:40:38,497 - INFO -   eval_similarity_min: 0.4679
2025-07-27 03:40:38,497 - INFO -   eval_similarity_max: 0.7446
2025-07-27 03:40:41,064 - INFO - Step 210: Loss=0.000181, PredSim=0.8357, EvalSim=0.7893 (good), SphereViol=0.000000, GradNorm=33.460, LR=4.99e-04 [OVERFIT TEST]
2025-07-27 03:40:41,064 - INFO -   Detailed metrics:
2025-07-27 03:40:41,064 - INFO -     loss: 0.000181
2025-07-27 03:40:41,064 - INFO -     total_loss: 0.000181
2025-07-27 03:40:41,064 - INFO -     reg_loss: 0.000000
2025-07-27 03:40:41,064 - INFO -     prediction_similarity: 0.835730
2025-07-27 03:40:41,064 - INFO -     eval_similarity: 0.789337
2025-07-27 03:40:41,065 - INFO -     similarity_std: 0.027999
2025-07-27 03:40:41,065 - INFO -     sphere_violation: 0.000000
2025-07-27 03:40:41,065 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:40:41,065 - INFO -     pred_norm: 1.404142
2025-07-27 03:40:41,065 - INFO -     target_norm: 1.570915
2025-07-27 03:40:41,065 - INFO -     clean_norm: 1.000000
2025-07-27 03:40:41,065 - INFO -     noise_norm: 1.000000
2025-07-27 03:40:41,065 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:40:41,065 - INFO -     error_norm: 0.839956
2025-07-27 03:40:41,065 - INFO -     relative_error: 0.534692
2025-07-27 03:40:41,065 - INFO -     step_count: 210.000000
2025-07-27 03:40:41,065 - INFO -     loss_ema: 0.000720
2025-07-27 03:40:41,065 - INFO -     similarity_ema: 0.623192
2025-07-27 03:40:41,065 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:40:41,065 - INFO -     timestep_mean: 0.629653
2025-07-27 03:40:41,066 - INFO -     timestep_std: 0.313925
2025-07-27 03:40:41,066 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:40:41,066 - INFO -     pred_min: -1.375000
2025-07-27 03:40:41,066 - INFO -     pred_max: 0.846680
2025-07-27 03:40:41,066 - INFO -     target_min: -1.394262
2025-07-27 03:40:41,066 - INFO -     target_max: 0.844863
2025-07-27 03:40:43,547 - INFO - Step 220: Loss=0.000161, PredSim=0.8547, EvalSim=0.7879 (good), SphereViol=0.000000, GradNorm=18.958, LR=4.98e-04 [OVERFIT TEST]
2025-07-27 03:40:43,548 - INFO -   Detailed metrics:
2025-07-27 03:40:43,548 - INFO -     loss: 0.000161
2025-07-27 03:40:43,548 - INFO -     total_loss: 0.000161
2025-07-27 03:40:43,548 - INFO -     reg_loss: 0.000000
2025-07-27 03:40:43,548 - INFO -     prediction_similarity: 0.854696
2025-07-27 03:40:43,548 - INFO -     eval_similarity: 0.787924
2025-07-27 03:40:43,548 - INFO -     similarity_std: 0.023814
2025-07-27 03:40:43,548 - INFO -     sphere_violation: 0.000000
2025-07-27 03:40:43,548 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:40:43,548 - INFO -     pred_norm: 1.290546
2025-07-27 03:40:43,548 - INFO -     target_norm: 1.570915
2025-07-27 03:40:43,548 - INFO -     clean_norm: 1.000000
2025-07-27 03:40:43,548 - INFO -     noise_norm: 1.000000
2025-07-27 03:40:43,548 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:40:43,548 - INFO -     error_norm: 0.791374
2025-07-27 03:40:43,549 - INFO -     relative_error: 0.503766
2025-07-27 03:40:43,549 - INFO -     step_count: 220.000000
2025-07-27 03:40:43,549 - INFO -     loss_ema: 0.000667
2025-07-27 03:40:43,549 - INFO -     similarity_ema: 0.644542
2025-07-27 03:40:43,549 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:40:43,549 - INFO -     timestep_mean: 0.629653
2025-07-27 03:40:43,549 - INFO -     timestep_std: 0.313925
2025-07-27 03:40:43,549 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:40:43,549 - INFO -     pred_min: -1.315430
2025-07-27 03:40:43,549 - INFO -     pred_max: 0.813477
2025-07-27 03:40:43,549 - INFO -     target_min: -1.394262
2025-07-27 03:40:43,549 - INFO -     target_max: 0.844863
2025-07-27 03:40:45,933 - INFO - Step 230: Loss=0.000143, PredSim=0.8745, EvalSim=0.7951 (good), SphereViol=0.000000, GradNorm=22.931, LR=4.98e-04 [OVERFIT TEST]
2025-07-27 03:40:45,933 - INFO -   Detailed metrics:
2025-07-27 03:40:45,933 - INFO -     loss: 0.000143
2025-07-27 03:40:45,933 - INFO -     total_loss: 0.000143
2025-07-27 03:40:45,933 - INFO -     reg_loss: 0.000000
2025-07-27 03:40:45,933 - INFO -     prediction_similarity: 0.874505
2025-07-27 03:40:45,933 - INFO -     eval_similarity: 0.795104
2025-07-27 03:40:45,933 - INFO -     similarity_std: 0.017728
2025-07-27 03:40:45,933 - INFO -     sphere_violation: 0.000000
2025-07-27 03:40:45,933 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:40:45,933 - INFO -     pred_norm: 1.477693
2025-07-27 03:40:45,933 - INFO -     target_norm: 1.570915
2025-07-27 03:40:45,933 - INFO -     clean_norm: 1.000000
2025-07-27 03:40:45,933 - INFO -     noise_norm: 1.000000
2025-07-27 03:40:45,933 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:40:45,934 - INFO -     error_norm: 0.746336
2025-07-27 03:40:45,934 - INFO -     relative_error: 0.475097
2025-07-27 03:40:45,934 - INFO -     step_count: 230.000000
2025-07-27 03:40:45,934 - INFO -     loss_ema: 0.000617
2025-07-27 03:40:45,934 - INFO -     similarity_ema: 0.665794
2025-07-27 03:40:45,934 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:40:45,934 - INFO -     timestep_mean: 0.629653
2025-07-27 03:40:45,934 - INFO -     timestep_std: 0.313925
2025-07-27 03:40:45,934 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:40:45,934 - INFO -     pred_min: -1.449219
2025-07-27 03:40:45,934 - INFO -     pred_max: 0.897461
2025-07-27 03:40:45,934 - INFO -     target_min: -1.394262
2025-07-27 03:40:45,934 - INFO -     target_max: 0.844863
2025-07-27 03:40:48,459 - INFO - Step 240: Loss=0.000126, PredSim=0.8884, EvalSim=0.7929 (good), SphereViol=0.000000, GradNorm=18.594, LR=4.98e-04 [OVERFIT TEST]
2025-07-27 03:40:48,459 - INFO -   Detailed metrics:
2025-07-27 03:40:48,459 - INFO -     loss: 0.000126
2025-07-27 03:40:48,459 - INFO -     total_loss: 0.000126
2025-07-27 03:40:48,459 - INFO -     reg_loss: 0.000000
2025-07-27 03:40:48,459 - INFO -     prediction_similarity: 0.888418
2025-07-27 03:40:48,459 - INFO -     eval_similarity: 0.792921
2025-07-27 03:40:48,459 - INFO -     similarity_std: 0.014214
2025-07-27 03:40:48,459 - INFO -     sphere_violation: 0.000000
2025-07-27 03:40:48,459 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:40:48,459 - INFO -     pred_norm: 1.371266
2025-07-27 03:40:48,460 - INFO -     target_norm: 1.570915
2025-07-27 03:40:48,460 - INFO -     clean_norm: 1.000000
2025-07-27 03:40:48,460 - INFO -     noise_norm: 1.000000
2025-07-27 03:40:48,460 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:40:48,460 - INFO -     error_norm: 0.700567
2025-07-27 03:40:48,460 - INFO -     relative_error: 0.445961
2025-07-27 03:40:48,460 - INFO -     step_count: 240.000000
2025-07-27 03:40:48,460 - INFO -     loss_ema: 0.000571
2025-07-27 03:40:48,460 - INFO -     similarity_ema: 0.686485
2025-07-27 03:40:48,460 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:40:48,460 - INFO -     timestep_mean: 0.629653
2025-07-27 03:40:48,460 - INFO -     timestep_std: 0.313925
2025-07-27 03:40:48,460 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:40:48,460 - INFO -     pred_min: -1.301758
2025-07-27 03:40:48,460 - INFO -     pred_max: 0.785645
2025-07-27 03:40:48,460 - INFO -     target_min: -1.394262
2025-07-27 03:40:48,460 - INFO -     target_max: 0.844863
2025-07-27 03:40:50,814 - INFO - [Step 250] Spherical Flow Debug:
2025-07-27 03:40:50,814 - INFO -   Loss: 0.000111 (quality: good)
2025-07-27 03:40:50,815 - INFO -   Prediction Sim: 0.9026
2025-07-27 03:40:50,815 - INFO -   Eval Sim: 0.7960
2025-07-27 03:40:50,815 - INFO -   Sphere Violation: 0.000000
2025-07-27 03:40:50,815 - INFO -   Norms - Pred: 1.468, Target: 1.571
2025-07-27 03:40:50,815 - INFO -   Error: 0.659 (relative: 0.419)
2025-07-27 03:40:50,815 - INFO -   Timesteps: 0.630 ¬± 0.314
2025-07-27 03:40:50,886 - INFO - Step 250: Loss=0.000111, PredSim=0.9026, EvalSim=0.7960 (good), SphereViol=0.000000, GradNorm=18.537, LR=4.97e-04 [OVERFIT TEST]
2025-07-27 03:40:50,886 - INFO -   Detailed metrics:
2025-07-27 03:40:50,886 - INFO -     loss: 0.000111
2025-07-27 03:40:50,886 - INFO -     total_loss: 0.000111
2025-07-27 03:40:50,886 - INFO -     reg_loss: 0.000000
2025-07-27 03:40:50,886 - INFO -     prediction_similarity: 0.902640
2025-07-27 03:40:50,886 - INFO -     eval_similarity: 0.795968
2025-07-27 03:40:50,886 - INFO -     similarity_std: 0.011362
2025-07-27 03:40:50,886 - INFO -     sphere_violation: 0.000000
2025-07-27 03:40:50,886 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:40:50,886 - INFO -     pred_norm: 1.468325
2025-07-27 03:40:50,886 - INFO -     target_norm: 1.570915
2025-07-27 03:40:50,886 - INFO -     clean_norm: 1.000000
2025-07-27 03:40:50,886 - INFO -     noise_norm: 1.000000
2025-07-27 03:40:50,887 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:40:50,887 - INFO -     error_norm: 0.658914
2025-07-27 03:40:50,887 - INFO -     relative_error: 0.419446
2025-07-27 03:40:50,887 - INFO -     step_count: 250.000000
2025-07-27 03:40:50,887 - INFO -     loss_ema: 0.000528
2025-07-27 03:40:50,887 - INFO -     similarity_ema: 0.706452
2025-07-27 03:40:50,887 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:40:50,887 - INFO -     timestep_mean: 0.629653
2025-07-27 03:40:50,887 - INFO -     timestep_std: 0.313925
2025-07-27 03:40:50,887 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:40:50,887 - INFO -     pred_min: -1.389648
2025-07-27 03:40:50,887 - INFO -     pred_max: 0.830078
2025-07-27 03:40:50,887 - INFO -     target_min: -1.394262
2025-07-27 03:40:50,887 - INFO -     target_max: 0.844863
2025-07-27 03:40:53,173 - INFO - Step 260: Loss=0.000096, PredSim=0.9165, EvalSim=0.7970 (good), SphereViol=0.000000, GradNorm=11.362, LR=4.97e-04 [OVERFIT TEST]
2025-07-27 03:40:53,173 - INFO -   Detailed metrics:
2025-07-27 03:40:53,173 - INFO -     loss: 0.000096
2025-07-27 03:40:53,173 - INFO -     total_loss: 0.000096
2025-07-27 03:40:53,173 - INFO -     reg_loss: 0.000000
2025-07-27 03:40:53,173 - INFO -     prediction_similarity: 0.916504
2025-07-27 03:40:53,173 - INFO -     eval_similarity: 0.797001
2025-07-27 03:40:53,173 - INFO -     similarity_std: 0.010203
2025-07-27 03:40:53,173 - INFO -     sphere_violation: 0.000000
2025-07-27 03:40:53,173 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:40:53,173 - INFO -     pred_norm: 1.457784
2025-07-27 03:40:53,173 - INFO -     target_norm: 1.570915
2025-07-27 03:40:53,173 - INFO -     clean_norm: 1.000000
2025-07-27 03:40:53,173 - INFO -     noise_norm: 1.000000
2025-07-27 03:40:53,173 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:40:53,173 - INFO -     error_norm: 0.611506
2025-07-27 03:40:53,173 - INFO -     relative_error: 0.389268
2025-07-27 03:40:53,173 - INFO -     step_count: 260.000000
2025-07-27 03:40:53,174 - INFO -     loss_ema: 0.000487
2025-07-27 03:40:53,174 - INFO -     similarity_ema: 0.725926
2025-07-27 03:40:53,174 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:40:53,174 - INFO -     timestep_mean: 0.629653
2025-07-27 03:40:53,174 - INFO -     timestep_std: 0.313925
2025-07-27 03:40:53,174 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:40:53,174 - INFO -     pred_min: -1.366211
2025-07-27 03:40:53,174 - INFO -     pred_max: 0.834961
2025-07-27 03:40:53,174 - INFO -     target_min: -1.394262
2025-07-27 03:40:53,174 - INFO -     target_max: 0.844863
2025-07-27 03:40:55,477 - INFO - Step 270: Loss=0.000084, PredSim=0.9272, EvalSim=0.7968 (good), SphereViol=0.000000, GradNorm=13.307, LR=4.97e-04 [OVERFIT TEST]
2025-07-27 03:40:55,478 - INFO -   Detailed metrics:
2025-07-27 03:40:55,478 - INFO -     loss: 0.000084
2025-07-27 03:40:55,478 - INFO -     total_loss: 0.000084
2025-07-27 03:40:55,478 - INFO -     reg_loss: 0.000000
2025-07-27 03:40:55,478 - INFO -     prediction_similarity: 0.927185
2025-07-27 03:40:55,478 - INFO -     eval_similarity: 0.796752
2025-07-27 03:40:55,478 - INFO -     similarity_std: 0.010288
2025-07-27 03:40:55,478 - INFO -     sphere_violation: 0.000000
2025-07-27 03:40:55,478 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:40:55,478 - INFO -     pred_norm: 1.418042
2025-07-27 03:40:55,478 - INFO -     target_norm: 1.570915
2025-07-27 03:40:55,478 - INFO -     clean_norm: 1.000000
2025-07-27 03:40:55,478 - INFO -     noise_norm: 1.000000
2025-07-27 03:40:55,478 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:40:55,478 - INFO -     error_norm: 0.574216
2025-07-27 03:40:55,478 - INFO -     relative_error: 0.365530
2025-07-27 03:40:55,478 - INFO -     step_count: 270.000000
2025-07-27 03:40:55,478 - INFO -     loss_ema: 0.000449
2025-07-27 03:40:55,478 - INFO -     similarity_ema: 0.744675
2025-07-27 03:40:55,478 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:40:55,478 - INFO -     timestep_mean: 0.629653
2025-07-27 03:40:55,478 - INFO -     timestep_std: 0.313925
2025-07-27 03:40:55,479 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:40:55,479 - INFO -     pred_min: -1.330078
2025-07-27 03:40:55,479 - INFO -     pred_max: 0.811035
2025-07-27 03:40:55,479 - INFO -     target_min: -1.394262
2025-07-27 03:40:55,479 - INFO -     target_max: 0.844863
2025-07-27 03:40:57,717 - INFO - Step 280: Loss=0.000074, PredSim=0.9365, EvalSim=0.7988 (good), SphereViol=0.000000, GradNorm=10.071, LR=4.96e-04 [OVERFIT TEST]
2025-07-27 03:40:57,718 - INFO -   Detailed metrics:
2025-07-27 03:40:57,718 - INFO -     loss: 0.000074
2025-07-27 03:40:57,718 - INFO -     total_loss: 0.000074
2025-07-27 03:40:57,718 - INFO -     reg_loss: 0.000000
2025-07-27 03:40:57,718 - INFO -     prediction_similarity: 0.936480
2025-07-27 03:40:57,718 - INFO -     eval_similarity: 0.798810
2025-07-27 03:40:57,718 - INFO -     similarity_std: 0.009979
2025-07-27 03:40:57,718 - INFO -     sphere_violation: 0.000000
2025-07-27 03:40:57,718 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:40:57,718 - INFO -     pred_norm: 1.481826
2025-07-27 03:40:57,718 - INFO -     target_norm: 1.570915
2025-07-27 03:40:57,718 - INFO -     clean_norm: 1.000000
2025-07-27 03:40:57,718 - INFO -     noise_norm: 1.000000
2025-07-27 03:40:57,718 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:40:57,718 - INFO -     error_norm: 0.537003
2025-07-27 03:40:57,718 - INFO -     relative_error: 0.341841
2025-07-27 03:40:57,718 - INFO -     step_count: 280.000000
2025-07-27 03:40:57,718 - INFO -     loss_ema: 0.000414
2025-07-27 03:40:57,718 - INFO -     similarity_ema: 0.762568
2025-07-27 03:40:57,718 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:40:57,718 - INFO -     timestep_mean: 0.629653
2025-07-27 03:40:57,718 - INFO -     timestep_std: 0.313925
2025-07-27 03:40:57,718 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:40:57,718 - INFO -     pred_min: -1.354492
2025-07-27 03:40:57,718 - INFO -     pred_max: 0.839844
2025-07-27 03:40:57,719 - INFO -     target_min: -1.394262
2025-07-27 03:40:57,719 - INFO -     target_max: 0.844863
2025-07-27 03:40:59,954 - INFO - Step 290: Loss=0.000098, PredSim=0.9214, EvalSim=0.8014 (excellent), SphereViol=0.000000, GradNorm=72.072, LR=4.96e-04 [OVERFIT TEST]
2025-07-27 03:40:59,955 - INFO -   Detailed metrics:
2025-07-27 03:40:59,955 - INFO -     loss: 0.000098
2025-07-27 03:40:59,955 - INFO -     total_loss: 0.000098
2025-07-27 03:40:59,955 - INFO -     reg_loss: 0.000000
2025-07-27 03:40:59,955 - INFO -     prediction_similarity: 0.921361
2025-07-27 03:40:59,955 - INFO -     eval_similarity: 0.801380
2025-07-27 03:40:59,955 - INFO -     similarity_std: 0.009855
2025-07-27 03:40:59,955 - INFO -     sphere_violation: 0.000000
2025-07-27 03:40:59,955 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:40:59,955 - INFO -     pred_norm: 1.621215
2025-07-27 03:40:59,955 - INFO -     target_norm: 1.570915
2025-07-27 03:40:59,955 - INFO -     clean_norm: 1.000000
2025-07-27 03:40:59,955 - INFO -     noise_norm: 1.000000
2025-07-27 03:40:59,955 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:40:59,955 - INFO -     error_norm: 0.626885
2025-07-27 03:40:59,955 - INFO -     relative_error: 0.399057
2025-07-27 03:40:59,955 - INFO -     step_count: 290.000000
2025-07-27 03:40:59,955 - INFO -     loss_ema: 0.000382
2025-07-27 03:40:59,955 - INFO -     similarity_ema: 0.778482
2025-07-27 03:40:59,955 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:40:59,955 - INFO -     timestep_mean: 0.629653
2025-07-27 03:40:59,955 - INFO -     timestep_std: 0.313925
2025-07-27 03:40:59,955 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:40:59,955 - INFO -     pred_min: -1.469727
2025-07-27 03:40:59,955 - INFO -     pred_max: 0.901367
2025-07-27 03:40:59,955 - INFO -     target_min: -1.394262
2025-07-27 03:40:59,955 - INFO -     target_max: 0.844863
2025-07-27 03:41:02,244 - INFO - [Step 300] Spherical Flow Debug:
2025-07-27 03:41:02,245 - INFO -   Loss: 0.000069 (quality: good)
2025-07-27 03:41:02,245 - INFO -   Prediction Sim: 0.9407
2025-07-27 03:41:02,245 - INFO -   Eval Sim: 0.7988
2025-07-27 03:41:02,245 - INFO -   Sphere Violation: 0.000000
2025-07-27 03:41:02,245 - INFO -   Norms - Pred: 1.480, Target: 1.571
2025-07-27 03:41:02,245 - INFO -   Error: 0.523 (relative: 0.333)
2025-07-27 03:41:02,245 - INFO -   Timesteps: 0.630 ¬± 0.314
2025-07-27 03:41:02,317 - INFO - Step 300: Loss=0.000069, PredSim=0.9407, EvalSim=0.7988 (good), SphereViol=0.000000, GradNorm=32.658, LR=4.95e-04 [OVERFIT TEST]
2025-07-27 03:41:02,317 - INFO -   Detailed metrics:
2025-07-27 03:41:02,317 - INFO -     loss: 0.000069
2025-07-27 03:41:02,317 - INFO -     total_loss: 0.000069
2025-07-27 03:41:02,317 - INFO -     reg_loss: 0.000000
2025-07-27 03:41:02,317 - INFO -     prediction_similarity: 0.940714
2025-07-27 03:41:02,317 - INFO -     eval_similarity: 0.798797
2025-07-27 03:41:02,317 - INFO -     similarity_std: 0.008060
2025-07-27 03:41:02,317 - INFO -     sphere_violation: 0.000000
2025-07-27 03:41:02,317 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:41:02,317 - INFO -     pred_norm: 1.479667
2025-07-27 03:41:02,317 - INFO -     target_norm: 1.570915
2025-07-27 03:41:02,317 - INFO -     clean_norm: 1.000000
2025-07-27 03:41:02,317 - INFO -     noise_norm: 1.000000
2025-07-27 03:41:02,317 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:41:02,317 - INFO -     error_norm: 0.523046
2025-07-27 03:41:02,317 - INFO -     relative_error: 0.332956
2025-07-27 03:41:02,318 - INFO -     step_count: 300.000000
2025-07-27 03:41:02,318 - INFO -     loss_ema: 0.000353
2025-07-27 03:41:02,318 - INFO -     similarity_ema: 0.793528
2025-07-27 03:41:02,318 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:41:02,318 - INFO -     timestep_mean: 0.629653
2025-07-27 03:41:02,318 - INFO -     timestep_std: 0.313925
2025-07-27 03:41:02,318 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:41:02,318 - INFO -     pred_min: -1.329102
2025-07-27 03:41:02,318 - INFO -     pred_max: 0.831543
2025-07-27 03:41:02,318 - INFO -     target_min: -1.394262
2025-07-27 03:41:02,318 - INFO -     target_max: 0.844863
2025-07-27 03:41:02,318 - INFO - Running evaluation at step 300...
2025-07-27 03:41:08,065 - INFO - Loaded shard 1/1: 2646 samples
2025-07-27 03:42:43,973 - INFO - Evaluation results:
2025-07-27 03:42:43,973 - INFO -   eval_eva_similarity: 0.5294
2025-07-27 03:42:43,973 - INFO -   eval_eva_similarity_std: 0.0421
2025-07-27 03:42:43,973 - INFO -   eval_angular_distance: 1.0063
2025-07-27 03:42:43,973 - INFO -   eval_sphere_violation: 0.0000
2025-07-27 03:42:43,973 - INFO -   eval_high_quality: 0.0000
2025-07-27 03:42:43,973 - INFO -   eval_very_high_quality: 0.0000
2025-07-27 03:42:43,973 - INFO -   eval_excellent_quality: 0.0000
2025-07-27 03:42:43,973 - INFO -   eval_samples: 504.0000
2025-07-27 03:42:43,973 - INFO -   eval_similarity_min: 0.4208
2025-07-27 03:42:43,973 - INFO -   eval_similarity_max: 0.6286
2025-07-27 03:42:46,582 - INFO - Step 310: Loss=0.000117, PredSim=0.8994, EvalSim=0.7966 (good), SphereViol=0.000000, GradNorm=124.098, LR=4.95e-04 [OVERFIT TEST]
2025-07-27 03:42:46,582 - INFO -   Detailed metrics:
2025-07-27 03:42:46,582 - INFO -     loss: 0.000117
2025-07-27 03:42:46,582 - INFO -     total_loss: 0.000117
2025-07-27 03:42:46,583 - INFO -     reg_loss: 0.000000
2025-07-27 03:42:46,583 - INFO -     prediction_similarity: 0.899373
2025-07-27 03:42:46,583 - INFO -     eval_similarity: 0.796599
2025-07-27 03:42:46,583 - INFO -     similarity_std: 0.008468
2025-07-27 03:42:46,583 - INFO -     sphere_violation: 0.000000
2025-07-27 03:42:46,583 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:42:46,583 - INFO -     pred_norm: 1.497958
2025-07-27 03:42:46,583 - INFO -     target_norm: 1.570915
2025-07-27 03:42:46,583 - INFO -     clean_norm: 1.000000
2025-07-27 03:42:46,583 - INFO -     noise_norm: 1.000000
2025-07-27 03:42:46,583 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:42:46,583 - INFO -     error_norm: 0.686711
2025-07-27 03:42:46,583 - INFO -     relative_error: 0.437141
2025-07-27 03:42:46,583 - INFO -     step_count: 310.000000
2025-07-27 03:42:46,583 - INFO -     loss_ema: 0.000332
2025-07-27 03:42:46,584 - INFO -     similarity_ema: 0.802581
2025-07-27 03:42:46,584 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:42:46,584 - INFO -     timestep_mean: 0.629653
2025-07-27 03:42:46,584 - INFO -     timestep_std: 0.313925
2025-07-27 03:42:46,584 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:42:46,584 - INFO -     pred_min: -1.357422
2025-07-27 03:42:46,584 - INFO -     pred_max: 0.856445
2025-07-27 03:42:46,584 - INFO -     target_min: -1.394262
2025-07-27 03:42:46,584 - INFO -     target_max: 0.844863
2025-07-27 03:42:49,041 - INFO - Step 320: Loss=0.000066, PredSim=0.9435, EvalSim=0.7995 (good), SphereViol=0.000000, GradNorm=28.801, LR=4.94e-04 [OVERFIT TEST]
2025-07-27 03:42:49,041 - INFO -   Detailed metrics:
2025-07-27 03:42:49,041 - INFO -     loss: 0.000066
2025-07-27 03:42:49,041 - INFO -     total_loss: 0.000066
2025-07-27 03:42:49,041 - INFO -     reg_loss: 0.000000
2025-07-27 03:42:49,041 - INFO -     prediction_similarity: 0.943492
2025-07-27 03:42:49,041 - INFO -     eval_similarity: 0.799452
2025-07-27 03:42:49,041 - INFO -     similarity_std: 0.008142
2025-07-27 03:42:49,041 - INFO -     sphere_violation: 0.000000
2025-07-27 03:42:49,041 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:42:49,041 - INFO -     pred_norm: 1.488874
2025-07-27 03:42:49,041 - INFO -     target_norm: 1.570915
2025-07-27 03:42:49,041 - INFO -     clean_norm: 1.000000
2025-07-27 03:42:49,041 - INFO -     noise_norm: 1.000000
2025-07-27 03:42:49,041 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:42:49,042 - INFO -     error_norm: 0.512705
2025-07-27 03:42:49,042 - INFO -     relative_error: 0.326374
2025-07-27 03:42:49,042 - INFO -     step_count: 320.000000
2025-07-27 03:42:49,042 - INFO -     loss_ema: 0.000308
2025-07-27 03:42:49,042 - INFO -     similarity_ema: 0.815220
2025-07-27 03:42:49,042 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:42:49,042 - INFO -     timestep_mean: 0.629653
2025-07-27 03:42:49,042 - INFO -     timestep_std: 0.313925
2025-07-27 03:42:49,042 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:42:49,042 - INFO -     pred_min: -1.321289
2025-07-27 03:42:49,042 - INFO -     pred_max: 0.806641
2025-07-27 03:42:49,042 - INFO -     target_min: -1.394262
2025-07-27 03:42:49,042 - INFO -     target_max: 0.844863
2025-07-27 03:42:51,489 - INFO - Step 330: Loss=0.000056, PredSim=0.9527, EvalSim=0.8000 (good), SphereViol=0.000000, GradNorm=13.393, LR=4.94e-04 [OVERFIT TEST]
2025-07-27 03:42:51,489 - INFO -   Detailed metrics:
2025-07-27 03:42:51,489 - INFO -     loss: 0.000056
2025-07-27 03:42:51,489 - INFO -     total_loss: 0.000056
2025-07-27 03:42:51,489 - INFO -     reg_loss: 0.000000
2025-07-27 03:42:51,489 - INFO -     prediction_similarity: 0.952654
2025-07-27 03:42:51,489 - INFO -     eval_similarity: 0.799972
2025-07-27 03:42:51,489 - INFO -     similarity_std: 0.007718
2025-07-27 03:42:51,489 - INFO -     sphere_violation: 0.000000
2025-07-27 03:42:51,490 - INFO -     sphere_constraint_loss: 0.000000
2025-07-27 03:42:51,490 - INFO -     pred_norm: 1.493040
2025-07-27 03:42:51,490 - INFO -     target_norm: 1.570915
2025-07-27 03:42:51,490 - INFO -     clean_norm: 1.000000
2025-07-27 03:42:51,490 - INFO -     noise_norm: 1.000000
2025-07-27 03:42:51,490 - INFO -     conditioning_norm: 1.000000
2025-07-27 03:42:51,490 - INFO -     error_norm: 0.468243
2025-07-27 03:42:51,490 - INFO -     relative_error: 0.298070
2025-07-27 03:42:51,490 - INFO -     step_count: 330.000000
2025-07-27 03:42:51,490 - INFO -     loss_ema: 0.000284
2025-07-27 03:42:51,490 - INFO -     similarity_ema: 0.827996
2025-07-27 03:42:51,490 - INFO -     sphere_violation_ema: 0.000000
2025-07-27 03:42:51,490 - INFO -     timestep_mean: 0.629653
2025-07-27 03:42:51,490 - INFO -     timestep_std: 0.313925
2025-07-27 03:42:51,490 - INFO -     interpolation_weight: 0.629883
2025-07-27 03:42:51,490 - INFO -     pred_min: -1.354492
2025-07-27 03:42:51,490 - INFO -     pred_max: 0.810059
2025-07-27 03:42:51,490 - INFO -     target_min: -1.394262
2025-07-27 03:42:51,491 - INFO -     target_max: 0.844863
2025-07-27 03:42:51,675 - INFO - Iteration completed: 2646 samples processed
2025-07-27 03:42:51,687 - INFO - Epoch 1 completed:
2025-07-27 03:42:51,687 - INFO -   Average loss: 0.000280
2025-07-27 03:42:51,687 - INFO -   Best loss: 0.000056
2025-07-27 03:42:51,688 - INFO -   Best similarity: 0.8014
2025-07-27 03:42:51,688 - ERROR - Training failed with error: sequence index must be integer, not 'slice'
2025-07-27 03:42:53,151 - INFO - Checkpoint saved: checkpoints/eva_repro_fixed_20250727_033558/checkpoint_step_330.pt
2025-07-27 03:42:53,152 - INFO - Running final evaluation...
2025-07-27 03:42:58,747 - INFO - Loaded shard 1/1: 2646 samples
2025-07-27 03:46:08,903 - INFO - Training completed!
2025-07-27 03:46:08,905 - INFO -   Total time: 590.8 seconds
2025-07-27 03:46:08,905 - INFO -   Total steps: 330
2025-07-27 03:46:08,905 - INFO -   Best loss: 0.000056
2025-07-27 03:46:08,905 - INFO -   Best EVA similarity: 0.8014
2025-07-27 03:46:08,905 - INFO -   Final evaluation:
2025-07-27 03:46:08,905 - INFO -     eval_eva_similarity: 0.5571
2025-07-27 03:46:08,905 - INFO -     eval_eva_similarity_std: 0.0530
2025-07-27 03:46:08,905 - INFO -     eval_angular_distance: 0.9714
2025-07-27 03:46:08,905 - INFO -     eval_sphere_violation: 0.0000
2025-07-27 03:46:08,905 - INFO -     eval_high_quality: 0.0000
2025-07-27 03:46:08,905 - INFO -     eval_very_high_quality: 0.0000
2025-07-27 03:46:08,905 - INFO -     eval_excellent_quality: 0.0000
2025-07-27 03:46:08,905 - INFO -     eval_samples: 1000.0000
2025-07-27 03:46:08,905 - INFO -     eval_similarity_min: 0.4232
2025-07-27 03:46:08,905 - INFO -     eval_similarity_max: 0.6847
2025-07-27 03:46:08,905 - INFO -   Overfitting test: ‚úÖ PASSED
2025-07-27 03:46:08,909 - INFO - 
================================================================================
2025-07-27 03:46:08,909 - INFO - üéâ SPHERICAL EVA DENOISING TRAINING COMPLETED!
2025-07-27 03:46:08,910 - INFO - ================================================================================
2025-07-27 03:46:08,910 - INFO - üìä RESULTS SUMMARY:
2025-07-27 03:46:08,910 - INFO -   Duration: 590.8 seconds (9.8 minutes)
2025-07-27 03:46:08,910 - INFO -   Total steps: 330
2025-07-27 03:46:08,910 - INFO -   Best loss: 0.000056
2025-07-27 03:46:08,910 - INFO -   üéØ Best EVA similarity: 0.8014
2025-07-27 03:46:08,910 - INFO - üìä FINAL EVALUATION RESULTS:
2025-07-27 03:46:08,910 - INFO -   üéØ EVA cosine similarity: 0.5571
2025-07-27 03:46:08,910 - INFO -   üìê Angular distance: 0.9714
2025-07-27 03:46:08,910 - INFO -   üîµ Sphere violation: 0.000000
2025-07-27 03:46:08,910 - INFO -   ‚ú® High quality (>0.7): 0.0%
2025-07-27 03:46:08,910 - INFO -   üåü Very high quality (>0.8): 0.0%
2025-07-27 03:46:08,910 - INFO -   üí´ Excellent quality (>0.9): 0.0%
2025-07-27 03:46:08,910 - INFO -   üìù Samples evaluated: 1000
2025-07-27 03:46:08,910 - INFO - ‚úÖ GOOD SUCCESS! EVA similarity > 0.5
2025-07-27 03:46:08,910 - INFO - üß™ OVERFITTING TEST: ‚úÖ PASSED
2025-07-27 03:46:08,910 - INFO -    ‚úÖ Model can learn and memorize - architecture is working perfectly!
2025-07-27 03:46:08,910 - INFO - üèóÔ∏è SPHERICAL EVA ARCHITECTURE ASSESSMENT:
2025-07-27 03:46:08,910 - INFO -    üéâ OUTSTANDING: Spherical EVA DiT architecture working perfectly!
2025-07-27 03:46:08,912 - INFO - üìÅ Final summary saved to checkpoints/eva_repro_fixed_20250727_033558/final_summary.json
2025-07-27 03:46:08,912 - INFO - üìÅ Model checkpoints saved to checkpoints/eva_repro_fixed_20250727_033558
2025-07-27 03:46:08,912 - INFO - ================================================================================
2025-07-27 03:46:08,912 - INFO - üéØ MISSION ACCOMPLISHED:
2025-07-27 03:46:08,912 - INFO -   ‚úÖ Spherical flow matching implemented
2025-07-27 03:46:08,913 - INFO -   ‚úÖ Unit hypersphere constraints maintained
2025-07-27 03:46:08,913 - INFO -   ‚úÖ EVA denoising task completed
2025-07-27 03:46:08,913 - INFO -   ‚úÖ Comprehensive evaluation performed
2025-07-27 03:46:08,913 - INFO -   üéØ Final EVA similarity: 0.8014
2025-07-27 03:46:08,913 - INFO - ================================================================================
